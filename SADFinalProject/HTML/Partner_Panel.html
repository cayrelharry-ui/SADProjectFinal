<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partner Panel - CNSC Extension</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../CSS/Partner_Panel.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-dark sidebar">
                <div class="position-sticky pt-3">
                    <div class="text-center mb-4">
                        <img src="../image.png" alt="CNSC Logo" class="mb-2" style="width: 50px; height: 50px;">
                        <h5 class="text-white">Partner Panel</h5>
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-section="dashboard">
                                <i class="bi bi-speedometer2"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="requests">
                                <i class="bi bi-file-earmark-text"></i> Partnership Requests
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="projects">
                                <i class="bi bi-briefcase"></i> Active Projects
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="documents">
                                <i class="bi bi-folder"></i> Documents
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="moa">
                                <i class="bi bi-handshake"></i> MOA Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="budget">
                                <i class="bi bi-cash-stack"></i> Budget Tracking
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="profile">
                                <i class="bi bi-person-circle"></i> Organization Profile
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a class="nav-link" href="#" onclick="openNewRequestModal(); return false;">
                                <i class="bi bi-plus-circle"></i> New Request
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <div>
                        <h1 class="h2" id="sectionTitle">Partner Panel</h1>
                        <p class="text-muted mb-0" id="userWelcome">Welcome back!</p>
                    </div>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="logoutBtn">
                                <i class="bi bi-box-arrow-right"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Section -->
                <div id="dashboard-section" class="section-content">
                    <!-- Welcome Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Welcome, <span id="orgNameDisplay">Partner Organization</span>!</h5>
                        </div>
                        <div class="card-body">
                            <p>Organization Type: <span id="orgTypeDisplay" class="badge bg-secondary"></span></p>
                            <p>Contact Email: <span id="orgEmailDisplay"></span></p>
                            <p>Status: <span id="orgStatusDisplay" class="badge bg-success">Active</span></p>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card text-white bg-primary">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="totalRequestsCount">0</h4>
                                            <p>Total Requests</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="bi bi-file-earmark-text fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-success">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="approvedRequestsCount">0</h4>
                                            <p>Approved</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="bi bi-check-circle fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-warning">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="pendingRequestsCount">0</h4>
                                            <p>Pending</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="bi bi-clock fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white bg-info">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="activeProjectsCount">0</h4>
                                            <p>Active Projects</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="bi bi-briefcase fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="mb-4">
                        <h3 class="h5 mb-3">Quick Actions</h3>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card h-100 border-primary">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-3">
                                            <div class="bg-primary bg-opacity-10 rounded p-2 me-3">
                                                <i class="bi bi-file-earmark-plus text-primary fs-4"></i>
                                            </div>
                                            <h6 class="card-title mb-0">New Partnership Request</h6>
                                        </div>
                                        <p class="card-text text-muted small">Submit a new partnership proposal with required documents</p>
                                        <button class="btn btn-sm btn-outline-primary" onclick="openNewRequestModal()">
                                            Get Started <i class="bi bi-arrow-right ms-1"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100 border-success">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-3">
                                            <div class="bg-success bg-opacity-10 rounded p-2 me-3">
                                                <i class="bi bi-handshake text-success fs-4"></i>
                                            </div>
                                            <h6 class="card-title mb-0">Manage MOA</h6>
                                        </div>
                                        <p class="card-text text-muted small">Upload or renew your Memorandum of Agreement</p>
                                        <button class="btn btn-sm btn-outline-success" onclick="navigateToSection('moa')">
                                            Get Started <i class="bi bi-arrow-right ms-1"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100 border-info">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-3">
                                            <div class="bg-info bg-opacity-10 rounded p-2 me-3">
                                                <i class="bi bi-cash-stack text-info fs-4"></i>
                                            </div>
                                            <h6 class="card-title mb-0">Track Budget</h6>
                                        </div>
                                        <p class="card-text text-muted small">Monitor budget allocation across all active projects</p>
                                        <button class="btn btn-sm btn-outline-info" onclick="navigateToSection('budget')">
                                            Get Started <i class="bi bi-arrow-right ms-1"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Requests -->
                    <div class="card mb-4">
                        <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Recent Partnership Requests</h5>
                            <button class="btn btn-light btn-sm" onclick="loadAllRequests()">
                                <i class="bi bi-arrow-clockwise"></i> Refresh
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="recentRequests" class="list-group list-group-flush">
                                <div class="list-group-item text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading recent requests...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Partnership Requests Section -->
                <div id="requests-section" class="section-content d-none">
                    <div class="card">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Partnership Requests</h5>
                            <div>
                                <button class="btn btn-light btn-sm me-2" onclick="openNewRequestModal()">
                                    <i class="bi bi-plus-circle"></i> New Request
                                </button>
                                <button class="btn btn-light btn-sm" onclick="loadAllRequests()">
                                    <i class="bi bi-arrow-clockwise"></i> Refresh
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Filter Options -->
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <select class="form-select" id="statusFilter">
                                        <option value="">All Status</option>
                                        <option value="pending">Pending</option>
                                        <option value="reviewed">Reviewed</option>
                                        <option value="approved">Approved</option>
                                        <option value="rejected">Rejected</option>
                                    </select>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" id="searchRequests" placeholder="Search requests...">
                                </div>
                            </div>

                            <!-- Requests Table -->
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Request ID</th>
                                            <th>Subject</th>
                                            <th>Date Submitted</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="requestsTableBody">
                                        <tr>
                                            <td colspan="5" class="text-center">
                                                <div class="spinner-border" role="status">
                                                    <span class="visually-hidden">Loading...</span>
                                                </div>
                                                <p class="mt-2">Loading requests...</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Projects Section -->
                <div id="projects-section" class="section-content d-none">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">Active Projects</h5>
                        </div>
                        <div class="card-body">
                            <div id="activeProjects">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading active projects...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documents Section -->
                <div id="documents-section" class="section-content d-none">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0">Documents & Attachments</h5>
                        </div>
                        <div class="card-body">
                            <div id="documentsList">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading documents...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MOA Management Section -->
                <div id="moa-section" class="section-content d-none">
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">MOA Management</h5>
                        </div>
                        <div class="card-body">
                            <div id="moaManagementContent">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading MOA management...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Budget Tracking Section -->
                <div id="budget-section" class="section-content d-none">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0">Budget Tracking</h5>
                        </div>
                        <div class="card-body">
                            <div id="budgetTrackingContent">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading budget information...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Organization Profile Section -->
                <div id="profile-section" class="section-content d-none">
                    <div class="card">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0">Organization Profile</h5>
                        </div>
                        <div class="card-body">
                            <div id="orgProfile">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2">Loading profile...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Status Alert -->
                <div class="alert alert-info mt-4" id="statusAlert" role="alert">
                    <strong>Status:</strong> <span id="statusMessage">Ready</span>
                </div>
            </main>
        </div>
    </div>

    <!-- Request Details Modal -->
    <div class="modal fade" id="requestDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Partnership Request Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="requestDetailsContent">
                    <!-- Content will be loaded dynamically -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Partnership Request Modal -->
    <div class="modal fade" id="newRequestModal" tabindex="-1" aria-labelledby="newRequestModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen-lg-down modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="newRequestModalLabel">
                        <i class="bi bi-plus-circle"></i> New Partnership Request
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0" style="max-height: calc(100vh - 120px); overflow-y: auto;">
                    <iframe id="partnerFormIframe" src="partner-form-modal.html" style="width: 100%; height: 100%; min-height: 600px; border: none;"></iframe>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MOA Details Modal -->
    <div class="modal fade" id="moaDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">MOA Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="moaDetailsContent">
                    <!-- MOA details loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../JS/Partner_Panel.js"></script>
    <script src="../JS/auth-check.js" type="module"></script>
</body>
</html>

